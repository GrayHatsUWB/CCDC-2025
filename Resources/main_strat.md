DEFENSIVE STRATEGY

-Change passwords – Prioritize most important passwords first, use long passphrases (>20 chars) and use unique ones for each system or application. The red team will either know the default passwords ahead of time or will discover them very quickly. The red team will assume you will re-use the same passwords across many systems (because most blue teams and real organizations do that) and they will try them everywhere. The red team will be working hard to grab password hashes for cracking. Short passwords only take minutes to crack, longer ones take hours. Password hashes that can’t be cracked can still be used immediately with “pass the hash” attacks that allow authentication. The red team wants your passwords and hashes because then they have *authorized* access to your systems, which is much harder for you to detect.

-Close the holes – Your firewall is actually your frontline of defense and if your firewall strategy includes a first step of stopping all traffic flow while it is reconfigured, that small part should also be considered TOP PRIORITY and concurrent with the step above. Implement the rest of your firewall strategy quickly while others are changing passwords. Once your firewall is configured to only allow the traffic you want, turn your attention to the other systems. Close ports that shouldn’t be open, stop services that shouldn’t be running or are not needed, patch and update to close vulnerability holes. Delete strange new accounts that should not be there (assume the red team will add accounts and upgrade them to admin/root status if possible).

-Monitor yourself – Monitor service status, network traffic, important logs. If you decide that you have the time and resources to do IDS, log correlation, integrity checking, that’s great. If you decide that you can’t do all those things, you must at least do some basic version of monitoring that keeps you aware of your network status and any anomalies.

-Clean up the mess after a penetration – After detecting a penetration, assess how far the penetration went. Identify any configuration changes that were made and correct them, find any malware left behind and eradicate it. The red team will be trying to install keyloggers and sniffers to gain more valuable information. The red team will be trying to install devices that give them legitimate access, back doors, trojaned services and executables, or even rootkits. Write up an incident response if possible to reduce the negative points.

-Change passwords again – After every compromise, change any password that was exposed, change all critical passwords if you have time. After every overnight period, assume the red team has either cracked all your passwords or obtained them in some other way and change all the critical passwords again.